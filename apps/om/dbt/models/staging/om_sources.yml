version: 2

sources:
  - name: raw
    schema: raw
    tables:
      - name: om_weather
        identifier: weather_hourly
        description: >
          Hourly weather data from the Open-Meteo API.
          Includes historical archive and forecast data.
          Both sources provide the same 4 natural weather variables.
        columns:
          - name: time
            description: "Hourly timestamp from tap-openmeteo (Europe/Rome timezone)"
            tests:
              - not_null
          - name: location_name
            description: "Location identifier from tap-openmeteo"
          - name: shortwave_radiation
            description: "Total solar radiation - GHI (W/m2)"
          - name: direct_radiation
            description: "Direct beam solar radiation on horizontal surface (W/m2)"
          - name: diffuse_radiation
            description: "Scattered solar radiation (W/m2)"
          - name: global_tilted_irradiance
            description: "Global tilted irradiance for PV panels (W/m2)"
          - name: cloud_cover
            description: "Total cloud cover (%)"
          - name: temperature_2m
            description: "Air temperature at 2m (C)"
          - name: precipitation
            description: "Total precipitation (mm)"

      - name: om_weather_features
        description: >
          Gold-layer ML features computed by the Python feature pipeline
          from silver weather data. Contains 29 features for energy
          consumption forecasting, identical for historical and forecast data.
        columns:
          - name: datetime
            description: "Hourly timestamp (Europe/Rome timezone)"
            tests:
              - not_null
              - unique

      - name: om_weather_features_meters
        description: >
          Gold-layer features for PV/solar metering. Contains 15 features
          focused on solar production forecasting, including clearsky_index,
          effective_solar_pv, and theoretical_prod.
        columns:
          - name: datetime
            description: "Hourly timestamp (Europe/Rome timezone)"
            tests:
              - not_null
              - unique
